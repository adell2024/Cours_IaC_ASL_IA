Get info about the cluster :
Bash

kubectl cluster-info

Get the nodes :
Bash

kubectl get nodes

With labels :
Bash

kubectl get nodes --show-labels

Create a namespace :
Bash

kubectl create namespace insafr

Set the context to this namespace :
Bash

kubectl config set-context --current --namespace=insa23fr

ğŸš€ Your first deployment

Monitor the events :
Bash

watch kubectl get events --sort-by=.metadata.creationTimestamp

Create deployment :
Bash

kubectl create deployment insafr23 --image=toto/insa23:1.0

Display pods and labels :
Bash

kubectl get pods
kubectl get pods --show-labels

Get into the pod :
Bash

kubectl exec -it pod-id -- /bin/bash

Inside the pod :
Bash

curl localhost:8080/hello

Manage the pod :
Bash

kubectl describe pod pod-id
kubectl delete pod pod-id

Scale deployment :
Bash

kubectl scale deployment insafr23 --replicas 3

ğŸŒ Expose your deployment

Expose via LoadBalancer :
Bash

kubectl expose deployment insafr23 --port 8080 --type=LoadBalancer

Get service info :
Bash

kubectl get service
# If public IP is available : 
curl public_ip:8080/hello

ğŸ”„ Roll-out new image

Update the container image :
Bash

kubectl set image deployment/insafr23 insafr23fr23=toto/insafr23:2.0

ğŸ“„ Apply manifests

Create and use a new namespace for manifests :
Bash

kubectl create namespace insafr-manifests
kubectl config set-context --current --namespace=insafr-manifests

Apply deployment manifest :
Bash

kubectl apply -f manifests/insafr23-v1-deployment.yml

Edit deployment :
Bash

kubectl edit deployment/insafr23
# Look for replicas, set it to 2, save and exit.

Apply Service manifest :
Bash

kubectl apply -f manifests/insafr23-service.yml

âš–ï¸ Requests and Limits

Test high CPU request (check for pending status) :
Bash

kubectl apply -f manifests/insafr23-v1-deployment-10cpus.yml

Setting standard requests and limits :
Bash

kubectl apply -f manifests/insafr23-v1-deployment-limits.yml

ğŸ©º Health probes

Deploy with health checks :
Bash

kubectl apply -f manifests/insafr23-v1-deployment-health.yml

Force the readiness probe to fail :
Bash

kubectl exec -it pod-id -- /bin/bash
# Inside the pod :
curl localhost:8080/health/misbehave

Observe pod's status (it should stop receiving traffic).

Make pod ready again :
Bash

curl localhost:8080/health/behave

Make pod a zombie (liveness check fail) :
Bash

curl localhost:8080/health/shoot
